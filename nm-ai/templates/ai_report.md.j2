# AI File Differ Report - {{ target_month }}

Generated on: {{ generated_on }}
Environment: {{ env }}

## Executive Summary

{% if stats_snapshot %}
### Current Stats Snapshot

- Total current records: {{ stats_snapshot.ai_total_current_records }}
- New this run: {{ stats_snapshot.ai_current_new_count }}
- Deletions this run: {{ stats_snapshot.ai_current_deletions_count }}
- Field-level changes: {{ stats_snapshot.ai_current_changes_count }}
{% if stats_snapshot.s_to_j_switches or stats_snapshot.j_to_s_switches %}- S→J switches: {{ stats_snapshot.s_to_j_switches }}
- J→S switches: {{ stats_snapshot.j_to_s_switches }}
{% endif %}

{% endif %}
### Excel File Changes Summary

{% if diff_report %}- **Total Rows Added**: {{ diff_totals.added }}
- **Total Rows Removed**: {{ diff_totals.removed }}
- **Total Rows Changed**: {{ diff_totals.changed }}

| Sheet | Added | Removed | Changed |
|-------|-------|---------|----------|
{% for row in diff_report %}| {{ row.sheet }} | {{ row.added }} | {{ row.removed }} | {{ row.changed }} |
{% endfor %}{% endif %}

---

## Detailed Analysis

{% if deletions_section %}### AI Current Deletions

Total deletions: {{ deletions_section.total }}

{% if not deletions_section.too_many %}| AI Code | AI | Name | Address Line 1 | City | Country |
|---------|----|----|----------------|------|----------|
{% for row in deletions_section.rows %}| {{ row.ai_code }} | {{ row.ai_name }} | {{ row.name }} | {{ row.address }} | {{ row.city }} | {{ row.country }} |
{% endfor %}{% else %}*Note: Too many deletions to display in full. See detailed Excel report.*

**Sample (first 20):**

| AI Code | AI | Name | Address Line 1 | City | Country |
|---------|----|----|----------------|------|----------|
{% for row in deletions_section.rows %}| {{ row.ai_code }} | {{ row.ai_name }} | {{ row.name }} | {{ row.address }} | {{ row.city }} | {{ row.country }} |
{% endfor %}{% endif %}

{% endif %}{% if jtos_section %}### AI J to S School Level Details

{% if jtos_section.empty %}**No J to S transitions found in this period.**

{% else %}Total AI codes with J to S transitions: {{ jtos_section.total }}

{% if not jtos_section.too_many %}| AI Code | Name | Address Line 1 | City | Country |
|---------|------|----------------|------|----------|
{% for row in jtos_section.rows %}| {{ row.ai_code }} | {{ row.name }} | {{ row.address }} | {{ row.city }} | {{ row.country }} |
{% endfor %}{% else %}*Note: Too many records to display in full. See detailed Excel report.*

**Sample (first 50):**

| AI Code | Name | Address Line 1 | City | Country |
|---------|------|----------------|------|----------|
{% for row in jtos_section.rows %}| {{ row.ai_code }} | {{ row.name }} | {{ row.address }} | {{ row.city }} | {{ row.country }} |
{% endfor %}{% endif %}
{% endif %}

{% endif %}{% if stoj_section %}### AI S to J School Level Details

{% if stoj_section.empty %}**No S to J transitions found in this period.**

{% else %}Total AI codes with S to J transitions: {{ stoj_section.total }}

{% if not stoj_section.too_many %}| AI Code | Name | Address Line 1 | City | Country |
|---------|------|----------------|------|----------|
{% for row in stoj_section.rows %}| {{ row.ai_code }} | {{ row.name }} | {{ row.address }} | {{ row.city }} | {{ row.country }} |
{% endfor %}{% else %}*Note: Too many records to display in full. See detailed Excel report.*

**Sample (first 50):**

| AI Code | Name | Address Line 1 | City | Country |
|---------|------|----------------|------|----------|
{% for row in stoj_section.rows %}| {{ row.ai_code }} | {{ row.name }} | {{ row.address }} | {{ row.city }} | {{ row.country }} |
{% endfor %}{% endif %}
{% endif %}

{% endif %}## Technical Details

- **Input File**: {{ args.infile }}
- **Output Directory**: {{ args.outdir }}
- **AWS Profile**: {{ args.profile }}
- **Verbose Mode**: {{ args.verbose }}
- **Detail Report**: {{ args.detail_report }}
- **Database Engine**: psycopg2

### Queries Executed

**Excel Diff Queries:**
- ai_domestic_trunc
- ai_intl_trunc
- ai_char_diffs

**Additional Analysis Queries:**
{% for query_name in additional_query_names %}- {{ query_name }}
{% endfor %}

---

*Report generated by AI File Differ script*
